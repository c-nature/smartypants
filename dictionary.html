<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordWise Dictionary & Thesaurus</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for a clean look */
        body {
            font-family: "Inter", sans-serif;
            background-color: #f0f2f5; /* Light gray background */
        }
        .container {
            max-width: 800px;
        }
        .input-field {
            border: 1px solid #d1d5db;
            padding: 10px;
            border-radius: 0.5rem; /* Rounded corners */
            outline: none;
            transition: border-color 0.2s;
        }
        .input-field:focus {
            border-color: #3b82f6; /* Blue border on focus */
        }
        .search-button, .quiz-button, .difficulty-button {
            background-color: #3b82f6; /* Blue button */
            color: white;
            padding: 10px 20px;
            border-radius: 0.5rem; /* Rounded corners */
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .search-button:hover, .quiz-button:hover, .difficulty-button:hover:not(.active) {
            background-color: #2563eb; /* Darker blue on hover */
        }
        .quiz-button {
            background-color: #8b5cf6; /* Purple for Quiz button */
        }
        .quiz-button:hover {
            background-color: #7c3aed;
        }
        .difficulty-button.active {
            background-color: #10b981; /* Green for active difficulty */
            cursor: default;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem; /* More rounded corners for cards */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow */
            padding: 1.5rem;
        }
        .audio-icon {
            cursor: pointer;
            color: #4a5568; /* Dark gray for icon */
            transition: color 0.2s;
        }
        .audio-icon:hover {
            color: #3b82f6; /* Blue on hover */
        }
        .message-box {
            background-color: #fee2e2; /* Light red for error */
            color: #ef4444; /* Dark red text */
            border: 1px solid #fca5a5;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            display: none; /* Hidden by default */
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: none; /* Hidden by default */
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .quiz-option-button {
            background-color: #e0e7ff; /* Light blue for options */
            color: #3b82f6;
            padding: 12px 20px;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            font-weight: 600;
            text-align: center;
        }
        .quiz-option-button:hover:not(.correct):not(.incorrect) {
            background-color: #c7d2fe;
            transform: translateY(-2px);
        }
        .quiz-option-button.correct {
            background-color: #d1fae5; /* Green for correct */
            color: #059669;
            border: 2px solid #10b981;
        }
        .quiz-option-button.incorrect {
            background-color: #fee2e2; /* Red for incorrect */
            color: #dc2626;
            border: 2px solid #ef4444;
        }
        .quiz-feedback {
            font-size: 1.25rem;
            font-weight: bold;
            margin-top: 1rem;
            text-align: center;
        }
        .quiz-feedback.correct-feedback {
            color: #059669; /* Green */
        }
        .quiz-feedback.incorrect-feedback {
            color: #dc2626; /* Red */
        }

        /* Tab specific styles */
        .tab-button {
            background-color: #e2e8f0; /* Light gray for inactive tab */
            color: #4a5568;
            padding: 10px 20px;
            border-radius: 0.5rem 0.5rem 0 0; /* Rounded top corners */
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            font-weight: 600;
            border-bottom: 2px solid transparent;
        }
        .tab-button:hover {
            background-color: #cbd5e0;
        }
        .tab-button.active-tab {
            background-color: white;
            color: #3b82f6; /* Blue for active tab */
            border-bottom: 2px solid #3b82f6;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <div class="container bg-white p-6 rounded-xl shadow-lg flex flex-col items-center">
        <h1 class="text-4xl font-extrabold text-gray-800 mb-6">WordWise</h1>

        <!-- Tab Navigation -->
        <div id="modeTabs" class="flex w-full mb-4">
            <button id="dictionaryTabButton" class="tab-button flex-1 text-lg active-tab">Dictionary</button>
            <button id="thesaurusTabButton" class="tab-button flex-1 text-lg">Thesaurus</button>
        </div>

        <div class="w-full flex items-center space-x-4 mb-6">
            <input
                type="text"
                id="wordInput"
                placeholder="Enter a word..."
                class="input-field flex-grow text-lg"
            />
            <button id="searchButton" class="search-button text-lg font-semibold">
                Search
            </button>
            <button id="quizModeButton" class="quiz-button text-lg font-semibold">
                Quiz
            </button>
            <div id="loadingSpinner" class="loading-spinner"></div>
        </div>

        <div id="messageBox" class="message-box w-full"></div>

        <!-- Dictionary/Thesaurus Section -->
        <div id="dictionaryThesaurusSection" class="w-full space-y-6">
            <div id="results" class="w-full space-y-6">
                <!-- Dictionary/Thesaurus results will be displayed here -->
            </div>
        </div>

        <!-- Quiz Section (Initially hidden) -->
        <div id="quizSection" class="w-full space-y-6 hidden">
            <h2 class="text-3xl font-bold text-gray-800 mb-4 text-center">Quiz Time!</h2>
            <div class="flex justify-center space-x-4 mb-6">
                <button id="easyDifficulty" class="difficulty-button text-sm font-semibold">Easy</button>
                <button id="normalDifficulty" class="difficulty-button text-sm font-semibold active">Normal</button>
                <button id="hardDifficulty" class="difficulty-button text-sm font-semibold">Hard</button>
            </div>
            <div class="card">
                <p class="text-lg text-gray-700 mb-4">Score: <span id="quizScore">0</span></p>
                <p id="quizDefinition" class="text-xl font-medium text-gray-900 mb-6"></p>
                <div id="quizOptions" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Quiz options will be dynamically loaded here -->
                </div>
                <p id="quizFeedback" class="quiz-feedback hidden"></p>
                <button id="nextQuestionButton" class="search-button mt-6 w-full hidden">Next Question</button>
            </div>
        </div>
    </div>

    <script>
        const wordInput = document.getElementById('wordInput');
        const searchButton = document.getElementById('searchButton');
        const resultsDiv = document.getElementById('results');
        const messageBox = document.getElementById('messageBox');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const quizModeButton = document.getElementById('quizModeButton');
        const dictionaryThesaurusSection = document.getElementById('dictionaryThesaurusSection'); // Renamed for clarity
        const quizSection = document.getElementById('quizSection');
        const quizDefinition = document.getElementById('quizDefinition');
        const quizOptionsDiv = document.getElementById('quizOptions');
        const quizFeedback = document.getElementById('quizFeedback');
        const nextQuestionButton = document.getElementById('nextQuestionButton');
        const quizScoreSpan = document.getElementById('quizScore');

        // Tab buttons
        const dictionaryTabButton = document.getElementById('dictionaryTabButton');
        const thesaurusTabButton = document.getElementById('thesaurusTabButton');

        // Difficulty buttons
        const easyDifficultyButton = document.getElementById('easyDifficulty');
        const normalDifficultyButton = document.getElementById('normalDifficulty');
        const hardDifficultyButton = document.getElementById('hardDifficulty');

        // Base URL for the DictionaryAPI.dev
        const API_BASE_URL = 'https://api.dictionaryapi.dev/api/v2/entries/en/';

        // Quiz related variables
        let currentQuizWord = '';
        let quizScore = 0;
        let currentDifficulty = 'normal'; // Default difficulty

        // Mode variable: 'dictionary', 'thesaurus', or 'quiz'
        let currentMode = 'dictionary'; // Default mode

        const quizWords = [
            "apple", "banana", "cat", "dog", "house", "tree", "water", "sun", "moon", "star",
            "book", "pen", "table", "chair", "computer", "phone", "music", "happy", "sad", "big",
            "small", "run", "walk", "eat", "sleep", "dream", "friend", "family", "city", "country",
            "ocean", "mountain", "river", "flower", "bird", "fish", "car", "train", "plane", "ship",
            "time", "day", "night", "morning", "evening", "hello", "goodbye", "thank", "please", "sorry",
            "adventure", "courage", "mystery", "serenity", "ephemeral", "ubiquitous", "benevolent", "cacophony",
            "dichotomy", "eloquence", "frugal", "gregarious", "haphazard", "idiosyncrasy", "juxtaposition",
            "kaleidoscope", "luminous", "meticulous", "nefarious", "obfuscate", "paradox", "quixotic",
            "resilience", "surreptitious", "tranquility", "unilateral", "vivacious", "whimsical", "xenophobia",
            "yearn", "zephyr", "abundant", "breeze", "charming", "delight", "enchant", "flourish",
            "gleam", "harmony", "inspire", "jovial", "keen", "lively", "magnify", "nurture", "optimistic",
            "peaceful", "quaint", "radiant", "sparkle", "thrive", "uplift", "vibrant", "wonder", "yield",
            "zest", "abstract", "bold", "crisp", "diverse", "elegant", "fluid", "graceful", "hollow",
            "intricate", "jolly", "kudos", "limpid", "modest", "nimble", "ornate", "placid", "quiver",
            "rustic", "subtle", "tangible", "unique", "vast", "witty", "exquisite", "youthful", "zenith"
        ];

        // Function to show messages (e.g., errors, no results)
        function showMessage(message, type = 'error') {
            messageBox.textContent = message;
            messageBox.className = `message-box w-full ${type === 'error' ? 'bg-red-100 text-red-700 border-red-300' : 'bg-green-100 text-green-700 border-green-300'} block`;
        }

        // Function to hide messages
        function hideMessage() {
            messageBox.style.display = 'none';
        }

        // Function to show/hide loading spinner
        function toggleLoading(show) {
            loadingSpinner.style.display = show ? 'block' : 'none';
            searchButton.disabled = show;
            wordInput.disabled = show;
            quizModeButton.disabled = show; // Disable quiz button during loading
            dictionaryTabButton.disabled = show; // Disable tab buttons during loading
            thesaurusTabButton.disabled = show; // Disable tab buttons during loading
            easyDifficultyButton.disabled = show;
            normalDifficultyButton.disabled = show;
            hardDifficultyButton.disabled = show;
        }

        // Function to play audio pronunciation
        function playAudio(url) {
            if (url) {
                const audio = new Audio(url);
                audio.play().catch(e => console.error("Error playing audio:", e));
            } else {
                console.warn("No audio URL provided.");
            }
        }

        // Function to switch between Dictionary and Thesaurus modes
        function switchMode(mode) {
            currentMode = mode;
            hideMessage();
            resultsDiv.innerHTML = ''; // Clear previous results

            // Update active tab styling
            dictionaryTabButton.classList.remove('active-tab');
            thesaurusTabButton.classList.remove('active-tab');
            if (mode === 'dictionary') {
                dictionaryTabButton.classList.add('active-tab');
            } else if (mode === 'thesaurus') {
                thesaurusTabButton.classList.add('active-tab');
            }

            // Ensure dictionary/thesaurus section is visible and quiz section is hidden
            dictionaryThesaurusSection.classList.remove('hidden');
            quizSection.classList.add('hidden');
            wordInput.focus(); // Focus on input field after switching mode
        }

        // Main function to search for a word
        async function searchWord() {
            const word = wordInput.value.trim().toLowerCase();
            if (!word) {
                showMessage("Please enter a word to search.");
                return;
            }

            resultsDiv.innerHTML = ''; // Clear previous results
            hideMessage();
            toggleLoading(true);

            // Ensure we are in dictionary/thesaurus view, not quiz
            dictionaryThesaurusSection.classList.remove('hidden');
            quizSection.classList.add('hidden');

            try {
                const response = await fetch(`${API_BASE_URL}${word}`);
                if (!response.ok) {
                    if (response.status === 404) {
                        showMessage(`"${word}" not found. Please check the spelling or try another word.`, 'info');
                    } else {
                        showMessage(`Error: ${response.status} - ${response.statusText}`, 'error');
                    }
                    return;
                }

                const data = await response.json();
                displayResults(data);

            } catch (error) {
                console.error("Fetch error:", error);
                showMessage("Could not connect to the dictionary API. Please try again later.", 'error');
            } finally {
                toggleLoading(false);
            }
        }

        // Function to display the fetched results based on currentMode
        function displayResults(data) {
            if (!data || data.length === 0) {
                showMessage("No results found for this word.", 'info');
                return;
            }

            data.forEach(entry => {
                const wordCard = document.createElement('div');
                wordCard.className = 'card mb-4';

                // Always display the word and phonetic information if available
                const header = document.createElement('div');
                header.className = 'flex items-center mb-4';

                const wordTitle = document.createElement('h2');
                wordTitle.className = 'text-3xl font-bold text-gray-900 mr-4';
                wordTitle.textContent = entry.word;
                header.appendChild(wordTitle);

                // Find the first available audio URL
                const audioUrl = entry.phonetics.find(p => p.audio)?.audio;
                if (audioUrl) {
                    const audioButton = document.createElement('button');
                    audioButton.className = 'audio-icon focus:outline-none';
                    audioButton.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.647 11.5 4.101 11.5 5v14c0 .899-.577 1.353-1.207.793L5.586 15z" />
                        </svg>
                    `;
                    audioButton.onclick = () => playAudio(audioUrl);
                    header.appendChild(audioButton);
                }

                const phoneticText = entry.phonetic || entry.phonetics.find(p => p.text)?.text;
                if (phoneticText) {
                    const phoneticSpan = document.createElement('span');
                    phoneticSpan.className = 'text-gray-600 ml-4 text-lg';
                    phoneticSpan.textContent = phoneticText;
                    header.appendChild(phoneticSpan);
                }
                wordCard.appendChild(header);

                // Conditional rendering based on current mode
                if (currentMode === 'dictionary') {
                    // Display meanings (definitions, examples)
                    entry.meanings.forEach(meaning => {
                        const meaningSection = document.createElement('div');
                        meaningSection.className = 'mb-4';

                        const partOfSpeech = document.createElement('h3');
                        partOfSpeech.className = 'text-xl font-semibold text-blue-700 mb-2 capitalize';
                        partOfSpeech.textContent = meaning.partOfSpeech;
                        meaningSection.appendChild(partOfSpeech);

                        const definitionsList = document.createElement('ul');
                        definitionsList.className = 'list-disc list-inside text-gray-700 space-y-2';

                        meaning.definitions.forEach((def, index) => {
                            const definitionItem = document.createElement('li');
                            definitionItem.innerHTML = `<span class="font-medium">${index + 1}.</span> ${def.definition}`;
                            if (def.example) {
                                definitionItem.innerHTML += `<p class="text-gray-500 italic ml-4 mt-1">"${def.example}"</p>`;
                            }
                            definitionsList.appendChild(definitionItem);
                        });
                        meaningSection.appendChild(definitionsList);

                        // Synonyms for dictionary mode
                        if (meaning.synonyms && meaning.synonyms.length > 0) {
                            const synonymsDiv = document.createElement('div');
                            synonymsDiv.className = 'mt-4';
                            synonymsDiv.innerHTML = `<span class="font-semibold text-gray-800">Synonyms:</span> <span class="text-gray-600">${meaning.synonyms.join(', ')}</span>`;
                            meaningSection.appendChild(synonymsDiv);
                        }

                        // Antonyms for dictionary mode
                        if (meaning.antonyms && meaning.antonyms.length > 0) {
                            const antonymsDiv = document.createElement('div');
                            antonymsDiv.className = 'mt-2';
                            antonymsDiv.innerHTML = `<span class="font-semibold text-gray-800">Antonyms:</span> <span class="text-gray-600">${meaning.antonyms.join(', ')}</span>`;
                            meaningSection.appendChild(antonymsDiv);
                        }

                        wordCard.appendChild(meaningSection);
                    });
                } else if (currentMode === 'thesaurus') {
                    // Aggregate and display only synonyms and antonyms for thesaurus mode
                    let allSynonyms = new Set();
                    let allAntonyms = new Set();

                    entry.meanings.forEach(meaning => {
                        if (meaning.synonyms) {
                            meaning.synonyms.forEach(syn => allSynonyms.add(syn));
                        }
                        if (meaning.antonyms) {
                            meaning.antonyms.forEach(ant => allAntonyms.add(ant));
                        }
                    });

                    if (allSynonyms.size > 0) {
                        const synonymsDiv = document.createElement('div');
                        synonymsDiv.className = 'mt-4 text-lg';
                        synonymsDiv.innerHTML = `<span class="font-semibold text-gray-800">Synonyms:</span> <span class="text-gray-600">${Array.from(allSynonyms).join(', ')}</span>`;
                        wordCard.appendChild(synonymsDiv);
                    }
                    if (allAntonyms.size > 0) {
                        const antonymsDiv = document.createElement('div');
                        antonymsDiv.className = 'mt-2 text-lg';
                        antonymsDiv.innerHTML = `<span class="font-semibold text-gray-800">Antonyms:</span> <span class="text-gray-600">${Array.from(allAntonyms).join(', ')}</span>`;
                        wordCard.appendChild(antonymsDiv);
                    }

                    if (allSynonyms.size === 0 && allAntonyms.size === 0) {
                        const noThesaurusData = document.createElement('p');
                        noThesaurusData.className = 'text-gray-600 italic mt-4';
                        noThesaurusData.textContent = 'No synonyms or antonyms found for this word.';
                        wordCard.appendChild(noThesaurusData);
                    }
                }

                resultsDiv.appendChild(wordCard);
            });
        }

        // --- Quiz Mode Functions ---

        // Function to set difficulty
        function setDifficulty(difficulty) {
            currentDifficulty = difficulty;
            easyDifficultyButton.classList.remove('active');
            normalDifficultyButton.classList.remove('active');
            hardDifficultyButton.classList.remove('active');

            if (difficulty === 'easy') {
                easyDifficultyButton.classList.add('active');
            } else if (difficulty === 'normal') {
                normalDifficultyButton.classList.add('active');
            } else { // hard
                hardDifficultyButton.classList.add('active');
            }
            // Restart quiz with new difficulty
            startQuiz();
        }

        // Function to start the quiz
        function startQuiz() {
            // Hide dictionary/thesaurus section and show quiz section
            dictionaryThesaurusSection.classList.add('hidden');
            quizSection.classList.remove('hidden');
            hideMessage();
            quizScore = 0;
            quizScoreSpan.textContent = quizScore;
            generateQuestion();
        }

        // Function to generate a new quiz question
        async function generateQuestion() {
            quizOptionsDiv.innerHTML = '';
            quizFeedback.classList.add('hidden');
            nextQuestionButton.classList.add('hidden');
            toggleLoading(true);

            let selectedWordData = null;
            let attempts = 0;
            const maxAttempts = 5;

            // Try to find a word with a definition from our list
            while (!selectedWordData && attempts < maxAttempts) {
                const randomIndex = Math.floor(Math.random() * quizWords.length);
                const word = quizWords[randomIndex];
                try {
                    const response = await fetch(`${API_BASE_URL}${word}`);
                    if (response.ok) {
                        const data = await response.json();
                        // Ensure the word has at least one meaning with a definition
                        if (data[0] && data[0].meanings && data[0].meanings.length > 0 &&
                            data[0].meanings[0].definitions && data[0].meanings[0].definitions.length > 0) {
                            selectedWordData = data[0];
                            currentQuizWord = word;
                        }
                    }
                } catch (error) {
                    console.error(`Error fetching word "${word}" for quiz:`, error);
                }
                attempts++;
            }

            if (!selectedWordData) {
                showMessage("Could not generate a quiz question. Please try again later.", 'error');
                toggleLoading(false);
                return;
            }

            // Get the FIRST definition from the selected word
            const firstDefinition = selectedWordData.meanings[0].definitions[0].definition;
            quizDefinition.textContent = `"${firstDefinition}"`; // Use the first definition

            // Determine number of incorrect options based on difficulty
            let numIncorrectOptions;
            if (currentDifficulty === 'easy') {
                numIncorrectOptions = 1;
            } else if (currentDifficulty === 'normal') {
                numIncorrectOptions = 3;
            } else { // hard
                numIncorrectOptions = 5;
            }

            // Generate multiple-choice options
            let options = [currentQuizWord];
            let incorrectWords = [];
            while (incorrectWords.length < numIncorrectOptions) {
                const randomIncorrectIndex = Math.floor(Math.random() * quizWords.length);
                const incorrectWord = quizWords[randomIncorrectIndex];
                // Ensure incorrect word is different from correct word and not already in options
                if (incorrectWord !== currentQuizWord && !options.includes(incorrectWord)) {
                    incorrectWords.push(incorrectWord);
                    options.push(incorrectWord);
                }
            }

            // Shuffle options
            options.sort(() => Math.random() - 0.5);

            options.forEach(optionWord => {
                const button = document.createElement('button');
                button.className = 'quiz-option-button';
                button.textContent = optionWord;
                button.onclick = () => checkAnswer(button, optionWord);
                quizOptionsDiv.appendChild(button);
            });

            toggleLoading(false);
        }

        // Function to check the selected answer
        function checkAnswer(selectedButton, chosenWord) {
            // Disable all option buttons after selection
            Array.from(quizOptionsDiv.children).forEach(button => {
                button.disabled = true;
                if (button.textContent === currentQuizWord) {
                    button.classList.add('correct'); // Highlight correct answer
                } else {
                    button.classList.add('opacity-50'); // Dim incorrect options
                }
            });

            if (chosenWord === currentQuizWord) {
                quizFeedback.textContent = "Correct!";
                quizFeedback.className = 'quiz-feedback correct-feedback';
                quizScore++;
            } else {
                quizFeedback.textContent = `Incorrect. The correct word was "${currentQuizWord}".`;
                quizFeedback.className = 'quiz-feedback incorrect-feedback';
                selectedButton.classList.add('incorrect'); // Highlight user's incorrect choice
            }
            quizFeedback.classList.remove('hidden');
            quizScoreSpan.textContent = quizScore;
            nextQuestionButton.classList.remove('hidden');
        }

        // Event Listeners
        searchButton.addEventListener('click', searchWord);
        wordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchWord();
            }
        });
        quizModeButton.addEventListener('click', startQuiz);
        nextQuestionButton.addEventListener('click', generateQuestion);

        // Tab button event listeners
        dictionaryTabButton.addEventListener('click', () => switchMode('dictionary'));
        thesaurusTabButton.addEventListener('click', () => switchMode('thesaurus'));

        // Difficulty button event listeners
        easyDifficultyButton.addEventListener('click', () => setDifficulty('easy'));
        normalDifficultyButton.addEventListener('click', () => setDifficulty('normal'));
        hardDifficultyButton.addEventListener('click', () => setDifficulty('hard'));


        // Focus on input and set initial mode when page loads
        window.onload = () => {
            wordInput.focus();
            switchMode('dictionary'); // Set initial mode to dictionary
        };
    </script>
</body>
</html>
